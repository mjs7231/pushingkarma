<!--
Budget data attributes:
  data-id: ID of the item being displayed.
  data-name: name of the model field td corresponds to.
  data-default: default value if left blank.
  data-url: API url to use when editing item.
  int,float,bool (class): Display int, float, or bool representaion
  selectall (class): Select all content when initializing edit.
  readonly (class): Do not allow editing this item.
  delempty (class): Delete category or transaction if value empty.
-->

{% verbatim %}
  <!-- Template:summary -->
  <script id='summary' type='text/x-handlebars-template'>
    <h2>Summary
      <div class='subtext'>
        {{addCommas this.count}} transactions
        {{yesNo this.uncategorized '|' ''}}
        {{#if this.uncategorized}}<a class='error' href='javascript:pk.budget.search("category=none")'>{{addCommas this.uncategorized}} uncategorized</a>{{/if}}
        {{yesNo this.unapproved '|' ''}}
        {{#if this.unapproved}}<a class='error' href='javascript:pk.budget.search("approved=false")'>{{addCommas this.unapproved}} unapproved</a>{{/if}}
      </div>
    </h2>
    <table cellpadding='0' cellspacing='0' style='clear:both;'>
      <thead><tr>
        <th class='average'>Average</th>
        {{#each this.categories.0.amounts}}
          <th>{{formatDate @key '%b'}}</th>
        {{/each}}
      </tr></thead>
      <tbody>
        {{#each this.categories}}
          <tr id='summary-{{this.categoryid}}' data-categoryid='{{this.categoryid}}'>
            <td class='average'><div>{{amountInt this.average}}</div></td>
            {{#each this.amounts}}
              <td class='{{budgetFlags ../budget this}}'><div>
                {{amountInt this}}
              </div></td>
            {{/each}}
          </tr>
        {{/each}}
      </tbody>
      <tfoot><tr>
        <td class='average'><div>{{amountInt this.avg_total}}</div></td>
        {{#each this.total}}
          <td class='{{yesNo this '' 'zero'}}'><div>
            {{amountInt this}}
          </div></td>
        {{/each}}
      </tr></tfoot>
    </table>
  </script>

  <!-- Template:category_list -->
  <script id='category_list' type='text/x-handlebars-template'>
    <table cellpadding='0' cellspacing='0'>
      <thead><tr>
        <th data-name='name'>Category</th>
        <th data-name='trend'>Trend</th>
        <th data-name='budget'>Budget</th>
      </tr></thead>
      <tbody>
        {{#each this.results}}
          <tr id='category-{{this.id}}' class='{{#unless_eq this.id 'null'}}rowedit{{/unless_eq}}' data-id='{{this.id}}' data-url='{{this.url}}'>
            <td data-name='name' class='rowitem delempty'><div>{{this.name}}</div></td>
            <td data-name='trend' class='rowitem readonly drag'><div>&nbsp;</div></td>
            <td data-name='budget' class='rowitem int selectall'><div>{{amountInt this.budget}}</div></td>
          </tr>
        {{/each}}
      </tbody>
      <tfoot> 
        <tr id='category-total'>
          <td data-name='name'><div>Total</div></td>
          <td data-name='trend'><div>&nbsp;</div></td>
          <td data-name='budget'><div>{{amountInt this.total}}</div></td>
        </tr>
        <tr id='category-add' data-url='/api/categories'>
          <td data-name='name'><input name='name' type='text' placeholder='New Category' autocomplete='off'></td>
          <td data-name='trend'>&nbsp;</td>
          <td data-name='budget' data-default='0'><input name='budget' type='integer' placeholder='$0' autocomplete='off'></td>
        </tr>
      </tfoot>
    </table>
  </script>

  <!-- Template:category_popover -->
  <script id='category_popover' type='text/x-handlebars-template'>
    <div style="padding:5px 10px;">
      <textarea></textarea><br/>
      This is the plan!
    </div>
  </script>

  <!-- Template:transaction_list -->
  <script id='transaction_list' type='text/x-handlebars-template'>
    <h2>Transactions
      <div class='subtext'>
        {{addCommas this.count}} transactions
        {{yesNo this.uncategorized '|' ''}}
        {{#if this.uncategorized}}<a class='error' href='javascript:pk.budget.search("category=none", true)'>{{addCommas this.uncategorized}} uncategorized</a>{{/if}}
        {{yesNo this.unapproved '|' ''}}
        {{#if this.unapproved}}<a class='error' href='javascript:pk.budget.search("approved=false", true)'>{{addCommas this.unapproved}} unapproved</a>{{/if}}
      </div>
    </h2>
    <table cellpadding='0' cellspacing='0' style='clear:both;'>
      <thead><tr>
        <th data-name='account'>Bank</th>
        <th data-name='date'>Date</th>
        <th data-name='payee'>Payee</th>
        <th data-name='category'>Category</th>
        <th data-name='amount'>Amount</th>
        <th data-name='approved'>X</th>
        <th data-name='comment'>Comment</th>
      </tr></thead>
      <tbody>
       {{#each this.results}}
         <tr id='transaction-{{this.id}}' class='rowedit' data-id='{{this.id}}' data-accountfid='{{this.accountfid}}' data-trxid='{{this.trxid}}' data-url='{{this.url}}'>
           <td data-name='account'><div>{{this.account}}</div></td>
           <td data-name='date' class='rowitem'><div>{{this.date}}</div></td>
           <td data-name='payee' class='rowitem selectall'><div>{{this.payee}}</div></td>
           <td data-name='category' class='rowitem selectall'><div>{{this.category}}</div></td>
           <td data-name='amount' class='rowitem float'><div>{{amountFloat this.amount}}</div></td>
           <td data-name='approved' class='rowitem bool selectall'><div>{{yesNo this.approved 'x' ''}}</div></td>
           <td data-name='comment' class='rowitem'><div>{{this.comment}}</div></td>
         </tr>
       {{/each}}
       {{#if this.next}}
         <tr id='transactions-more' data-next='{{this.next}}'>
           <td colspan='100%'>Loading more transactions..</td>
         </tr>
       {{/if}}
      </tbody>
    </table>
  </script>
{% endverbatim %}
